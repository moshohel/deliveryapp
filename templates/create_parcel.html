{% extends "base.html" %} {% load static %}
{% block content %}

<h3>Create Parcel</h3>
<form class="row g-3" action="/core/create_parcel" method="POST">
    {% csrf_token %}

    <div class="col-md-4">
        <label for="validationDefault01"
            class="form-label">Merchant</label>
        <select class="form-select" name="merchant"
            id="validationDefault01" required>
            <option selected disabled value="">
                Select Merchant
            </option>
            {% for merchant in merchants %}
            <option value="{{merchant.id}}">
                {{merchant.name}}
            </option>
            {% endfor %}
        </select>
    </div>

    <div class="col-md-4">
        <label for="validationDefault02" class="form-label">Product
            Type</label>
        <input type="text" class="form-control"
            id="validationDefault02" placeholder="Product type"
            name="product_type" required />
    </div>

    <div class="col-md-4">
        <label for="validationDefault02" class="form-label">Product
            Weight</label>
        <input type="text" class="form-control"
            id="validationDefault03" placeholder="Product Weight"
            name="weight_in_gram" required />
    </div>

    <div class="col-md-6">
        <label for="validationDefault03"
            class="form-label">Division</label>
        <select class="form-select" name="division" id="division_id"
            required>
            <option selected disabled value="">
                Select Division
            </option>
            {% for division in divisions %}
            <option value="{{division.id}}">
                {{division.name}}
            </option>
            {% endfor %}
        </select>
    </div>

    <div class="col-md-6">
        <label for="validationDefault04"
            class="form-label">District</label>
        <select class="form-select" name="district" id="district-area"
            required>
            <option selected disabled value="">
                District
            </option>
            {% for district in districts %}
            <option value="{{district.id}}">
                {{district.name}}
            </option>
            {% endfor %}
        </select>
    </div>

    <div class="col-12">
        <label for="validationDefault06"
            class="form-label">Address</label>
        <input type="text" class="form-control"
            id="validationDefault03" placeholder="Address"
            name="address" required />
    </div>
    <div class="col-12">
        <button class="btn btn-primary" type="submit">
            Create Parcel
        </button>
    </div>
</form>

{% endblock content %}

{% block script %}

<!-- Google Ajax API -->
<script
    src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- Districts respect to Division Using API -->
<script>
    $(document).ready(function () {
        $('#division_id').change(function () {
            var division = $('#division_id').val();
            // Send an ajax request to server with this division
            $('#district-area').html('');
            var option = '';
            var url = '';
            $.get(
                url + '/get-districts/' + division,
                function (data) {
                    data = JSON.parse(data);
                    data.forEach(function (element) {
                        option +=
                            "<option value='" +
                            element.pk +
                            "'>" +
                            element.fields.name +
                            '</option>';
                    });

                    $('#district-area').html(option);
                }
            );
        });
    });
</script>

{% endblock script %}